<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"loliconkelvin.github.io","root":"/","images":"/images","scheme":"Pisces","version":"8.7.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":true,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content=".red {     color: red; }  .blue {     color: blue; }   图书管理系统">
<meta property="og:type" content="article">
<meta property="og:title" content="Java小项目——图书管理系统">
<meta property="og:url" content="https://loliconkelvin.github.io/2022/02/28/Java%E5%B0%8F%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/index.html">
<meta property="og:site_name" content="萝莉控的小窝">
<meta property="og:description" content=".red {     color: red; }  .blue {     color: blue; }   图书管理系统">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s4.ax1x.com/2022/03/01/bQ8fO0.png">
<meta property="og:image" content="https://s4.ax1x.com/2022/03/01/bQgfjP.png">
<meta property="og:image" content="https://s4.ax1x.com/2022/03/05/b0ou8O.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/14/bL5Fw8.png">
<meta property="article:published_time" content="2022-02-28T01:40:17.000Z">
<meta property="article:modified_time" content="2022-03-29T12:13:15.804Z">
<meta property="article:author" content="Loliconkelvin">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s4.ax1x.com/2022/03/01/bQ8fO0.png">


<link rel="canonical" href="https://loliconkelvin.github.io/2022/02/28/Java%E5%B0%8F%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://loliconkelvin.github.io/2022/02/28/Java%E5%B0%8F%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/","path":"2022/02/28/Java小项目——图书管理系统/","title":"Java小项目——图书管理系统"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Java小项目——图书管理系统 | 萝莉控的小窝</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">萝莉控的小窝</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#22-02-28"><span class="nav-number">1.</span> <span class="nav-text">22&#x2F;02&#x2F;28</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-01"><span class="nav-number">2.</span> <span class="nav-text">22&#x2F;03&#x2F;01</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8D%89%E6%8B%9F%E5%90%97idea%E5%9D%91%E4%BA%86%E6%88%91%E4%B8%A4%E4%B8%AA%E6%99%9A%E4%B8%8A%EF%BC%88%E6%96%B0%E7%89%88idea%E5%88%9B%E5%BB%BAweb%E9%A1%B9%E7%9B%AE%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%89"><span class="nav-number">2.1.</span> <span class="nav-text">草拟吗idea坑了我两个晚上（新版idea创建web项目的方法）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-02"><span class="nav-number">3.</span> <span class="nav-text">22&#x2F;03&#x2F;02</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-03"><span class="nav-number">4.</span> <span class="nav-text">22&#x2F;03&#x2F;03</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-04"><span class="nav-number">5.</span> <span class="nav-text">22&#x2F;03&#x2F;04</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-05"><span class="nav-number">6.</span> <span class="nav-text">22&#x2F;03&#x2F;05</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#datatable-js"><span class="nav-number">6.1.</span> <span class="nav-text">datatable.js</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-06"><span class="nav-number">7.</span> <span class="nav-text">22&#x2F;03&#x2F;06</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-07"><span class="nav-number">8.</span> <span class="nav-text">22&#x2F;03&#x2F;07</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-08"><span class="nav-number">9.</span> <span class="nav-text">22&#x2F;03&#x2F;08</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-09"><span class="nav-number">10.</span> <span class="nav-text">22&#x2F;03&#x2F;09</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-10"><span class="nav-number">11.</span> <span class="nav-text">22&#x2F;03&#x2F;10</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-11"><span class="nav-number">12.</span> <span class="nav-text">22&#x2F;03&#x2F;11</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-12"><span class="nav-number">13.</span> <span class="nav-text">22&#x2F;03&#x2F;12</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-13"><span class="nav-number">14.</span> <span class="nav-text">22&#x2F;03&#x2F;13</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-03-14"><span class="nav-number">15.</span> <span class="nav-text">22&#x2F;03&#x2F;14</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Loliconkelvin"
      src="/uploads/avatar.png">
  <p class="site-author-name" itemprop="name">Loliconkelvin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">38</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Loliconkelvin" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Loliconkelvin" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:loliconkelvin@gmail.com" title="E-Mail → mailto:loliconkelvin@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://loliconkelvin.github.io/2022/02/28/Java%E5%B0%8F%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.png">
      <meta itemprop="name" content="Loliconkelvin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="萝莉控的小窝">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Java小项目——图书管理系统
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-02-28 09:40:17" itemprop="dateCreated datePublished" datetime="2022-02-28T09:40:17+08:00">2022-02-28</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-03-29 20:13:15" itemprop="dateModified" datetime="2022-03-29T20:13:15+08:00">2022-03-29</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">Java项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <style>
.red {
    color: red;
}

.blue {
    color: blue;
}
</style>

<p>图书管理系统</p>
<span id="more"></span>

<h2 id="22-02-28"><a href="#22-02-28" class="headerlink" title="22/02/28"></a>22/02/28</h2><ul>
<li><p>预选jar包</p>
<ul>
<li>c3p0-0.9.1.2</li>
<li>commons-beanutils-1.8.0</li>
<li>commons-beanutils-1.8.3</li>
<li>commons-collections-3.2.1</li>
<li>commons-dbutils-1.6</li>
<li>commons-fileupload-1.2.1</li>
<li>commons-io-1.4</li>
<li>commons-lang-2.5</li>
<li>commons-logging</li>
<li>commons-logging-1.1.1</li>
<li>ezmorph-1.0.6</li>
<li>fastjson-1.1.34</li>
<li>FileLoad</li>
<li>json-lib-2.3-jdk15</li>
<li>jsonplugin-0.34</li>
<li>jstl</li>
<li>morph-1.1.1</li>
<li>morph-sandbox-1.1.1</li>
<li>mysql-connector-java-5.1.7-bin</li>
<li>poi-3.8-20120326</li>
<li>poi-excelant-3.8-20120326</li>
<li>poi-ooxml-3.8-20120326</li>
<li>poi-scratchpad-3.8-20120326</li>
<li>standard<br /></li>
</ul>
</li>
<li><p>定下前端所使用的模板(支出 10)</p>
<br /></li>
<li><p>主页编辑</p>
<ul>
<li>确定index.jsp运行成功</li>
<li>确定index重定向到login成功</li>
</ul>
</li>
<li><p>主页素材相关：</p>
<ul>
<li>登录界面左蓝色色块 -》 style/style.css:1850</li>
<li>蓝色色块处应有背景图，但无法显示（路径问题？）1851行（已注释）</li>
<li>src=”xxx?method=xxxxx()”<br /></li>
</ul>
</li>
<li><p>已创建编辑404 500错误页面（<span class="red">页面素材未确定</span>）</p>
<br /></li>
<li><p>编辑index.jsp</p>
<br /></li>
<li><p>初试登录认证(LoginServlet.java)</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://tomcat.apache.org/tomcat-5.5-doc/servletapi/javax/servlet/http/HttpServlet.html">官方说明文档？</a></li>
<li>serialVersionUID不知道有没有用 先留着</li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41007534/article/details/99696559">相关教程</a><br /></li>
</ul>
<ol>
<li>创建HttpServlet<br> 重写HttpServlet的doGet(),doPost()方法</li>
<li>……</li>
</ol>
</li>
<li><p>22/02/28 22:24 推倒重做</p>
</li>
</ul>
<h2 id="22-03-01"><a href="#22-03-01" class="headerlink" title="22/03/01"></a>22/03/01</h2><ul>
<li><p>新建数据库<br>  <a target="_blank" rel="noopener" href="https://imgtu.com/i/bQ8fO0"><img src="https://s4.ax1x.com/2022/03/01/bQ8fO0.png" alt="bQ8fO0.png"></a></p>
  <br />

<ul>
<li><p>新建表：</p>
<ol>
<li><p><span class="blue">(已与视频同步)</span>user（用户表）：</p>
<ul>
<li>id</li>
<li>name</li>
<li>pwd</li>
<li>state(目前用于表示账号状态 1激活 0封禁)(<span class="blue">后期可能更改为 1管理员 0用户</span>)</li>
</ul>
</li>
<li><p><span class="blue">(已与视频同步)</span>type（书籍类型表）：</p>
<ul>
<li>id</li>
<li>name</li>
<li>parentid(表示该类型的父类型)</li>
</ul>
</li>
<li><p><span class="blue">(已与视频同步)</span>book（书籍信息表）：</p>
<ul>
<li>id</li>
<li>typeId</li>
<li>name</li>
<li>price</li>
<li>desc(表示书籍介绍)</li>
<li>publish(表示出版社)</li>
<li>author</li>
<li>stock(表示库存)</li>
</ul>
</li>
<li><p><span class="blue">(已与User合并)</span>memberType（用户类型表）</p>
<ul>
<li>name</li>
<li>amount</li>
<li>discount</li>
<li>recharge（<span class="red">后期可以删除</span>）</li>
<li>keepDay</li>
</ul>
</li>
<li><p><span class="blue">(已与User合并)</span>member（特殊用户信息表？）</p>
<ul>
<li>name</li>
<li>psw</li>
<li>type</li>
<li>balance（<span class="red">后期可以删除</span>）</li>
<li>regdate</li>
<li>tel</li>
<li>idNumber</li>
</ul>
</li>
<li><p><span class="blue">(已与视频同步)</span>record（记录表）</p>
<ul>
<li>id（表示记录编号）</li>
<li>bookid（表示书籍编号）（外键）</li>
<li>rentDate（借出日期）</li>
<li>backDate（归还日期）</li>
<li>userid（用户ID）（外键）</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ul>
<br />

<ul>
<li><p>新建idea-javaweb项目</p>
<ul>
<li>LibraryManagementSys</li>
<li>Java 11.0.10</li>
<li>Tomcat 10.0.16</li>
</ul>
</li>
<li><p>导入第三方jar（c3p0，mysql连接包）</p>
</li>
<li><p>放入c3p0配置文件（需要与包位于同一层次）</p>
</li>
<li><p>（13:11）已经成功通过java访问数据库</p>
<ul>
<li>数据库测试用代码：<pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">import java.sql.*;

public class Main &#123;
    public static void main(String[] args)&#123;
        getConnection();
    &#125;

    public static Connection getConnection() &#123;

        Connection con &#x3D; null;
        try &#123;
            System.out.println(&quot;begin.&quot;);
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            &#x2F;&#x2F; 数据库地址 用户名 密码在此 根据需要更改
            con &#x3D; DriverManager.getConnection(&quot;jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;bookdb?&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;UTC&quot;,&quot;root&quot;,&quot;123456&quot;);
            &#x2F;&#x2F; 输出end即为连接成功
            System.out.println(&quot;end.&quot;);
        &#125;
        catch (Exception e) &#123;
            System.out.println(e);
        &#125;
        return con;
    &#125;
&#125;</code></pre>
<br /></li>
</ul>
</li>
<li><p>成功将模板部署到Tomcat，目前未见元素丢失</p>
<br /></li>
<li><p>通过idea连接数据库生成表实体类</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jpfss/p/11122023.html">相关教程</a></p>
</li>
<li><p>不同点：<br><img src="https://s4.ax1x.com/2022/03/01/bQgfjP.png" alt="bQgfjP.png"></p>
</li>
<li><p>JavaBean要求</p>
<ol>
<li>继承Serializable</li>
<li>私有属性</li>
<li>getter/setter</li>
<li>默认构造方法<br /></li>
</ol>
</li>
</ul>
</li>
<li><p>实体类UserDao的编写（Data Access Objects数据库访问层）</p>
<ul>
<li>该类主要通过连接mysql的user表查询是否存在这样的数据</li>
</ul>
<ol>
<li>连接mysql<ul>
<li>注意：使用到的dbhelper连接数据库方法如下：<pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&#x2F;&#x2F; 指定sql地址，密码，用户名
DBHelper.init(&quot;jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;bookdb?&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;UTC&quot;,&quot;123456&quot;,&quot;root&quot;);
&#x2F;&#x2F; dbhelper的构造方法中含有连接mysql的方法，new对象即为连接
DBHelper con &#x3D; new DBHelper();

&#x2F;&#x2F; 取得connection对象的方法为：
con.conn</code></pre></li>
</ul>
</li>
<li>调用查询方法（<span class="red">涉及反射</span>）<ul>
<li><a target="_blank" rel="noopener" href="https://commons.apache.org/proper/commons-dbutils/apidocs/org/apache/commons/dbutils/QueryRunner.html">QueryRunner官方说明文档</a></li>
<li>通过调用QueryRunner中的<code>runner.query(connertion对象, 要执行的sql语句, 接收类（涉及反射）, 向sql语句传入的参数);</code>向数据裤查询，成功则返回对象，无结果则返回null<blockquote>
<p>注意：传入的参数要与sql语句中?所对应的接收变量顺序相同</p>
</blockquote>
</li>
</ul>
</li>
<li>关闭连接<ul>
<li>使用dbhelper中的<code>close()</code>方法关闭连接</li>
</ul>
</li>
<li>返回查询到的对象<br /></li>
</ol>
</li>
<li><p>UserBiz类的编写（业务层）</p>
<ul>
<li>该类用于调用UserDao中的getUser方法，处理其抛出的错误，并且将获取到的User返回给网页</li>
<li>其实就是用于处理”我能不能从数据库中拿出来信息”,”我拿出来了什么信息”,”遇到这些情况我要怎么做”</li>
<li>在此处出现的错误信息，我们可以在日志中看到<br /></li>
</ul>
</li>
<li><p>UserServlet类的编写（处理页面请求）</p>
<ul>
<li>该类主要用于处理jsp页面发送过来的请求</li>
<li>虚拟地址：（web3.0之后）<ul>
<li>使用<code>@WebServlet()</code>注解完成该类的虚拟地址定义，定义过后，不需要在web.xml中指定servlet，如：<pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&#x2F;&#x2F; 在web项目下‘&#x2F;’表示项目的根目录，指webapp目录
@WebServlet(&quot;&#x2F;user.let&quot;)</code></pre></li>
</ul>
</li>
<li>servlet类必须继承自HttpServlet，并且重写<code>dopost()</code>和<code>doGet()</code>方法<ul>
<li>关于<code>doPost()</code><blockquote>
<p>当jsp发送post请求至该servlet时，执行该方法</p>
</blockquote>
<ol>
<li>地址栏的请求</li>
<li>超链接</li>
<li>&lt;form method=’get’&gt;</li>
<li>跳转</li>
<li>重定向</li>
</ol>
</li>
<li>关于<code>doGet()</code><blockquote>
<p>当jsp发送get请求至该servlet时，执行该方法</p>
</blockquote>
<ul>
<li>&lt;form method=’post’&gt;<br /></li>
</ul>
</li>
</ul>
</li>
</ul>
<ol>
<li>判断用户的请求类型为login<ul>
<li>调用该servlet的用户请求会以<code>/user.let?type=xxx</code>的格式进入，因此需要判断type的值</li>
<li>使用<code>getParameter(参数名);</code>根据参数名获取其参数值</li>
</ul>
</li>
<li>获取用户名和密码<ul>
<li><span class="red">前端请注意表单提交数据：<ol>
<li>用户名表单组件 必须指明 name=”username”</li>
<li>密码表单组件 必须指明 name=”password”</span></li>
</ol>
</li>
</ul>
</li>
<li>调用UserBiz的getUser方法，并传入用户名和密码</li>
<li>判断返回的对象是否为null<ul>
<li>null-&gt;用户名密码不正确<ol>
<li>使用<code>resp.getWriter()</code>获取到网页响应的输出流，该输出流对象中的<code>println()</code>或<code>print()</code>方法可以向前端写入信息，甚至可以写html代码</li>
</ol>
</li>
<li>对象-&gt;登陆成功，保存登录日志操作，跳转页面</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="草拟吗idea坑了我两个晚上（新版idea创建web项目的方法）"><a href="#草拟吗idea坑了我两个晚上（新版idea创建web项目的方法）" class="headerlink" title="草拟吗idea坑了我两个晚上（新版idea创建web项目的方法）"></a>草拟吗idea坑了我两个晚上（新版idea创建web项目的方法）</h3><ul>
<li>创建一个普通的java项目，在左边目录右键项目名，选第二个添加框架，选择web application 4.0</li>
<li>配置tomcat，添加deployment，加号选第一个</li>
</ul>
<br />
<br />

<ul>
<li><p>用户登录补充：</p>
<ul>
<li>使用<code>req.getSession();</code>获取当前会话，返回会话对象</li>
<li>使用<code>会话对象.setAttribute();</code>方法为当前会话增加指定的属性并附上指定的值，用于保存用户登录信息</li>
</ul>
</li>
<li><p>（22:54）已确定实现用户登录</p>
</li>
</ul>
<br />

<ul>
<li>欢迎语实时改变用户名已实现<ul>
<li>在jsp页面使用EL表达式中的变量占位符<code>$&#123;user.name&#125;</code>获取用户名</li>
</ul>
</li>
<li>用户登出已实现<ul>
<li>原理与登入相同</li>
</ul>
</li>
</ul>
<h2 id="22-03-02"><a href="#22-03-02" class="headerlink" title="22/03/02"></a>22/03/02</h2><ul>
<li>导入个人资料页面，准备完成修改密码功能<ul>
<li><span class="red">前端注意：需要做一个js 实现新旧密码不能相同，新密码与密码的重复输入需要相同，密码不能为空（密码为空时仍有返回值 返回不是null<br>而是””）</span></li>
</ul>
</li>
<li>用户修改密码Dao的编写<ol>
<li>连接数据库</li>
<li>拿到当前用户id和新密码</li>
<li>准备sql语句</li>
<li>执行sql语句（密码修改成功会返回修改数据的行数，修改失败返回0）</li>
<li>返回密码修改行数并关闭连接</li>
</ol>
</li>
<li>用户修改密码biz的编写<ul>
<li>调用修改密码Dao</li>
<li>返回面修改行数</li>
</ul>
</li>
<li>用户修改密码servlet的编写<ol>
<li>获取当前用户id和新密码</li>
<li>调用修改密码biz</li>
<li>验证修改密码是否成功<ul>
<li>成功：<span class="blue">（新增：清空当前会话）</span>返回登录页面</li>
<li>失败：返回个人资料页面</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="22-03-03"><a href="#22-03-03" class="headerlink" title="22/03/03"></a>22/03/03</h2><ul>
<li><p>图书类型bean已生成</p>
</li>
<li><p>图书类型Dao的编写：</p>
<ul>
<li><p>思路是一样的（后续不再写，只写要点）：</p>
<ol>
<li>连接数据库</li>
<li>准备sql语句</li>
<li>运行sql语句</li>
<li>关闭连接</li>
<li>返回值</li>
</ol>
</li>
<li><p>要点：</p>
<ol>
<li>连接数据库应该需要用时才连接，而不是连接一次占用很久，因此将连接数据库放在方法内而不是类里面</li>
<li>sql插入语句<code>INSERT INTO type VALUES(值1, 值2, ...)</code><ul>
<li>保证一个最大id的行被删除之后,下一个焙增加的行的id为最大id+1,需要使用:<blockquote>
<p>这条语句可以保证新增的行id紧跟目前的最大id</p>
</blockquote>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">ALTER TABLE type auto_increment &#x3D; 1;</code></pre></li>
</ul>
</li>
<li>对于设置了自增的列, 不传入该列的值,但要传入null占位,否则后面列的数据会传到前面的列</li>
<li>增删改都可以用<code>runner.update();</code>方法,它不需要将修改的内容用一个handler接收<br /></li>
</ol>
</li>
<li><p>自创方法–解决删除元素之后,新增加的元素id断层问题–在每次删除元素之后设置主键从最大数开始自增</p>
</li>
<li><p><span class="red">目前一条runner的方法执行一条语句,要执行多条可以将sql语句分开多次执行</span></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">ALTER TABLE type auto_increment &#x3D; 1</code></pre></li>
</ul>
</li>
<li><p>图书类型Biz类型的编写:</p>
<ul>
<li><p>都是调用Dao中的方法,捕获其错误,若有错误则返回null或0</p>
</li>
<li><p>唯一特殊的地方是:<span class="red">我们不能删除有书籍信息的类型</span></p>
<br /></li>
<li><p>实现不能删除含有书籍的类型信息:</p>
<ul>
<li><span class="blue">基本思路是当我们删除一个书籍类型的时候,需要先根据书籍类型id去book数据库表查询一下有没有这个类型id的书</span></li>
</ul>
<ol>
<li><p>因为涉及到书本库表,提前将book导出到Bean</p>
</li>
<li><p>建立BookDao</p>
</li>
<li><p>根据思路,创建根据类型id查询书籍的方法,相关sql语句:</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">SELECT * FROM book WHERE typeId&#x3D;1;</code></pre>
<blockquote>
<p>查询结果:</p>
</blockquote>
<ul>
<li><p>会输出一个Book类型的集合</p>
</li>
<li><p>有数据则这样输出:books = [Book{id=1, typeId=1, name=’呐喊’, price=114514.0, desc=’哼哼啊啊啊啊啊啊啊啊’, pic=’c://‘, publish=’恶臭出版社’, author=’野兽先辈’}]</p>
</li>
<li><p>即使没有数据,也会这样输出(此时集合不为null但长度为0):[]</p>
</li>
<li><p>突破点:books.size()</p>
</li>
</ul>
</li>
</ol>
</li>
<li><p>在Type的Biz层(<span class="red">Biz层的功能现在体现</span>)调用该方法,并且判断返回的集合长度是否为0,若是则向上抛出异常提示不能删除,若否则执行删除</p>
<br /></li>
</ul>
</li>
<li><p>TypeServlet的编写</p>
<ul>
<li><p>TypeServlet需要处理的业务:</p>
<ol>
<li>类型的增加(有表单)</li>
<li>类型的修改(有表单)<ul>
<li>类型修改准备页面(无表单 保存至req 转发至修改页面)</li>
</ul>
</li>
<li>类型的删除(从地址栏获取删除的类型id)</li>
</ol>
</li>
<li><p>(<span class="blue">特殊</span>)类型查询:</p>
<ul>
<li>转至一个表单(表格)页面,当项目运行时(<span class="red">涉及监听器</span>),数据库中数据会保存到application对象中</li>
<li><span class="red">servlet中可以存放数据的对象</span><ol>
<li>request(同一个请求中传输信息)</li>
<li>session(同一个会话中传输信息)</li>
<li>application(同一个项目中传输信息)(通常用于存放一个项目中不太经常变化的数据)<br /></li>
</ol>
</li>
</ul>
</li>
<li><p>监听器(@WebListener)</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhizhuodewo6/article/details/82019409">监听器注解</a></li>
<li>定义<code>@WebListener</code>,将该类注册为一个Application监听器, 当项目开始运行时,该类会自动执行<br /></li>
<li>要实现监听器,该类需要实现ServletContextListener接口,重写里面的两个方法</li>
<li>contextInitialized是当项目部署时执行的方法<br>  通过其参数ServletContextEvent.getServletContext可以获得servlet运行环境信息application</li>
<li>contextDestroyed是当项目摧毁时执行的方法</li>
</ul>
</li>
<li><p>jstl(标准标签库)</p>
<ul>
<li>要展示一个动态的表格,需要很多表格标签,jstl可以帮我们完成这个工作</li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/jsp/jsp-jstl.html">jspl标准标签库</a><br /></li>
</ul>
</li>
<li><p><span class="red">前端注意,此处增加图书类型,不做额外的页面,效果为在图书类型列表中弹出添加类型的悬浮框</span></p>
</li>
<li><p>书籍类型添加功能</p>
<ul>
<li><p>前端</p>
<ul>
<li><p>使用jspl+EL表达式实现以表单的方式输出数据库内容</p>
</li>
<li><p>要点:</p>
<ol>
<li>要使用jspl,需要在jsp头下声明<pre class="line-numbers language-jsp" data-language="jsp"><code class="language-jsp">&lt;%@taglib prefix&#x3D;&quot;jspl&quot; uri&#x3D;&quot;http:&#x2F;&#x2F;java.sun.com&#x2F;jsp&#x2F;jstl&#x2F;core&quot; %&gt;</code></pre></li>
<li>实现根据读取到的数据行数重复输出各种标签,使用forEach<br> items表示取到的对象名,可以通过’.’取到对象里面的某个属性的值<br> var表示取到的每个对象的名称,例如下面意思是,取到的每个对象都叫type,也可以通过’.’来取得对象的属性</li>
</ol>
  <pre class="line-numbers language-jsp" data-language="jsp"><code class="language-jsp">&lt;jspl:forEach items&#x3D;&quot;$&#123;types&#125;&quot; var&#x3D;&quot;type&quot;&gt;
          &lt;option value&#x3D;&quot;$&#123;type.id&#125;&quot;&gt;$&#123;type.name&#125;&lt;&#x2F;option&gt;
&lt;&#x2F;jspl:forEach&gt;</code></pre></li>
</ul>
</li>
<li><p>后端</p>
<ol>
<li>获取表单元素:<ul>
<li>要点:<ul>
<li>取过来的都是string类型,可以使用每个类型对应的类的<code>parseXXX</code>方法进行转换</li>
</ul>
</li>
</ul>
</li>
<li>执行Biz层方法</li>
<li>更新application<ul>
<li>要点:<ul>
<li>使用<code>setAttribute();</code>方法将最新的数据库内容覆盖过去</li>
</ul>
</li>
</ul>
</li>
<li>返回结果</li>
</ol>
</li>
</ul>
</li>
<li><p>书籍类型删除功能已实现</p>
</li>
<li><p>书籍类型修改功能</p>
<h2 id="22-03-04"><a href="#22-03-04" class="headerlink" title="22/03/04"></a>22/03/04</h2></li>
</ul>
</li>
<li><p>出现错误<br>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/RonaldMH/article/details/116675297">java.lang.NoClassDefFoundError: javax/servlet/jsp/tagext/TagLibraryValidator</a></p>
<ul>
<li>原因:Tomcat10之后不支持导入javax包</li>
</ul>
</li>
<li><p><span class="red">前端注意:图书类型刷新功能没有按钮(刷新列表) 图书类型添加页面没有按钮 图书类型重排列没有按钮</span></p>
</li>
<li><p>图书类型后端已完成</p>
</li>
<li><p><span class="red">后端注意:突然想到可以增加一个方法 防止用户重名</span></p>
</li>
<li><p>图书类型前端:</p>
<ul>
<li><span class="red">前端注意:目前包含bookList bookAdd bookChange三个页面,但是之后要做图书类型添加和图书类型修改都以悬浮窗的形式展现</span></li>
<li>在这之后(图书类型管理和图书管理)前端使用到了jspl(图书类型管理页面每个页面有一两个吧),详细原理请看源码</li>
<li>关于转发与重定向<br>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/h2503652646/article/details/83661347">转发与重定向</a><br /></li>
</ul>
</li>
<li><p>书籍Dao的编写</p>
<ul>
<li>书籍Dao需要完成<ol>
<li>添加书籍</li>
<li>修改书籍内容</li>
<li>删除书籍</li>
<li>通过ID获取一本书籍</li>
<li>分页获取<ul>
<li>sql语句：<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">-- 查询(分页)
&#x2F;*语法:SELECT * FROM LIMIT [OFFSET,] ROW
LIMIT可以被用于强制select语句返回指定的记录数
若给定两个参数,第一个参数为偏移量,第二个参数为返回记录行的最大数量
初始记录行的偏移量是0
*&#x2F;
-- OFFSET计算方式(若每页2行)
&#x2F;*第一页 0
    第二页 2
    第三页 4
    也就是 每页显示行数*(当前页码-1)
*&#x2F;
SELECT * FROM book LIMIT 0,2;</code></pre></li>
</ul>
</li>
<li>获取书籍总数，分页时使用<ul>
<li>sql语句：<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">SELECT COUNT(id) FROM book;</code></pre></li>
<li>该方法主要为前端分页做准备</li>
<li>因为该查询语句只会返回一行一列，因此可以使用<a target="_blank" rel="noopener" href="https://blog.csdn.net/boss_way/article/details/78407781">ScalarHandler</a>封装单个值，该数据以Object类型返回<ol>
<li>并且返回的一定是数字，是一个<span class="blue">Long类</span>的值,可以将其强制转换为long类型并转为int类型</li>
<li>也可以直接使用Number类接收，然后使用里面的方法转换为int类型</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
<li><p><span class="blue">删除类型ID重排列方法，重排列后会导致ID与类型配对与原来不同，书籍属性中的类型会改变</span></p>
</li>
</ul>
<br />

<ul>
<li>书籍Biz的编写<ul>
<li>分页获取方法：<ul>
<li>因为目前拿到的book.type都为null，所以该方法需要补充type外键的内容</li>
<li>而每个bookl都存有typeId，因此可以通过typeId传入到Type类并使用方法getTpyeById获得对应的type，再通过setter给book设置type即可。</li>
</ul>
</li>
<li>通过取得书籍总量计算页数的方法：<blockquote>
<p>((总行数-1)/每页显示行数) + 1</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h2 id="22-03-05"><a href="#22-03-05" class="headerlink" title="22/03/05"></a>22/03/05</h2><ul>
<li><p>书籍servlet的编写</p>
<ul>
<li>前端<br><span class="red">前端注意：目前添加书籍，修改书籍和书籍列表是分开的页面，届时请将增加书籍和修改书籍作为书籍列表页面的悬浮窗</span><br><span class="red">后端注意：做一个在书籍创建，选择书籍类型时也能增加新类型的业务</span><br><span class="blue">后端注意：在书籍列表做一个搜索功能（如果可以，做模糊查询）（已经通过dataTables实现）</span></li>
</ul>
  <br />

<ul>
<li>后端<ul>
<li>书籍servlet需要完成的业务：<ol>
<li>增加书籍</li>
<li>改变书籍属性（预备）</li>
<li>改变书籍属性</li>
<li>根据页码获取书籍</li>
<li>根据ID获取书籍</li>
</ol>
</li>
<li>注意：新玩具datatable.js</li>
<li><span class="red">后端注意：图书详情功能暂时放弃，有冗余代码</span></li>
<li><span class="red">后端注意：修改书籍界面的书籍名称一栏为只读</span></li>
<li><span class="red">前端注意：拿掉请求的空格</span><br>  <img src="https://s4.ax1x.com/2022/03/05/b0ou8O.png" alt="b0ou8O.png"><h3 id="datatable-js"><a href="#datatable-js" class="headerlink" title="datatable.js"></a>datatable.js</h3></li>
</ul>
</li>
</ul>
</li>
<li><p>普天同庆分页不用管！！！！ohhhhhhhhhhhhhhhhh</p>
</li>
<li><p>原理未知</p>
<ul>
<li><span class="red">后端注意：因为自动排序所以会产生冗余代码，详见BookServlet中getByPage方法</span></li>
</ul>
</li>
</ul>
<h2 id="22-03-06"><a href="#22-03-06" class="headerlink" title="22/03/06"></a>22/03/06</h2><ul>
<li>今天研究新玩具dataTables的使用方法，首先献上<a target="_blank" rel="noopener" href="http://datatables.club/">datatables中文网</a></li>
</ul>
<br />

<ul>
<li>使用dataTables：<ol>
<li>下载jquery库、基本的dataTables样式文件和dataTables的js并且引用到网页</li>
<li>当然首先你得有个表格：(这里把官方例子搬了过来)<ul>
<li><span class="red">注意：使用dataTables，必须指定表头</span><pre class="line-numbers language-HTML" data-language="HTML"><code class="language-HTML">&lt;table id&#x3D;&quot;example&quot; class&#x3D;&quot;display&quot; cellspacing&#x3D;&quot;0&quot; width&#x3D;&quot;100%&quot;&gt;
&lt;thead&gt;
  &lt;tr&gt;
      &lt;!-- 这里是表头 --&gt;
    &lt;th&gt;Name&lt;&#x2F;th&gt;
    &lt;th&gt;Position&lt;&#x2F;th&gt;
    &lt;th&gt;Office&lt;&#x2F;th&gt;
    &lt;th&gt;Age&lt;&#x2F;th&gt;
    &lt;th&gt;Start date&lt;&#x2F;th&gt;
    &lt;th&gt;Salary&lt;&#x2F;th&gt;
  &lt;&#x2F;tr&gt;
&lt;&#x2F;thead&gt;

&lt;tbody&gt;
  &lt;!-- 这里是表格数据 --&gt;
&lt;&#x2F;tbody&gt;
&lt;&#x2F;table&gt;</code></pre></li>
</ul>
</li>
<li>初始化表格（变个魔术）<ul>
<li>在html页面添加如下代码<pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;script&gt;
    $(document).ready(function () &#123;
    $(&#39;#example&#39;).DataTable();
    &#125;);
&lt;&#x2F;script&gt;</code></pre></li>
</ul>
</li>
</ol>
<ul>
<li>然后表格就出来了，目前还是他的初始样式</li>
</ul>
</li>
</ul>
<br />

<ul>
<li><p>功能的启用/禁用</p>
<ul>
<li><p>功能设置</p>
<ul>
<li>在<code>DataTable()</code>中传入参数，格式如下：<pre class="line-numbers language-JS" data-language="JS"><code class="language-JS">DataTable(&#123;
    &quot;autoWidth&quot;: true,
    &quot;info&quot;: false
&#125;);</code></pre></li>
</ul>
</li>
<li><p>自定义样式</p>
<ul>
<li>dataTables文件夹内提供了很多样式插件，导入该样式插件的js和css即可应用样式（样式的命名为<code>dataTables.&#123;style&#125;.js</code> <code>dataTables.&#123;style&#125;.css</code>）</li>
</ul>
</li>
<li><p>自动列宽 autoWidth</p>
<ul>
<li>若自己指定了列宽，禁用该项可以增强性能</li>
</ul>
</li>
<li><p>左下角详细信息 info</p>
<ul>
<li>启用该项则左下角会显示目前显示数据总数和目前显示的数据编号</li>
</ul>
</li>
<li><p>排序功能 ordering</p>
<ul>
<li>开启该功能后，点击表头某项，将该列以A-Z顺序或反向排序</li>
</ul>
</li>
<li><p>国际化 language</p>
<ul>
<li>首先献上<a target="_blank" rel="noopener" href="https://datatables.net/plug-ins/i18n/Chinese.html">dataTable中文翻译下载</a></li>
<li>在<code>DataTable()</code>中传入如下参数：<pre class="line-numbers language-JS" data-language="JS"><code class="language-JS">language: &#123;
    url: &#39;&#123;FileName&#125;.json&#39;
&#125;</code></pre></li>
</ul>
</li>
</ul>
</li>
<li><p>总结：很棒，下次还用</p>
</li>
</ul>
<br />

<ul>
<li>管理员/用户个人主页，图书列表，图书类型列表已经基本修改完成</li>
</ul>
<h2 id="22-03-07"><a href="#22-03-07" class="headerlink" title="22/03/07"></a>22/03/07</h2><ul>
<li><p>将MemberDao结合于用户管理Dao中</p>
<ul>
<li>当需要查询一个数据有没有外键时的第二种方法：<ul>
<li>直接在UserDao查询（该案例没有用于代码 代码用第一种方法，见书籍类型Biz）</li>
<li>直接在userDao新建一个方法，使用如下sql语句进行查询<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">SELECT COUNT(id) FROM record WHERE userid &#x3D; ?;</code></pre></li>
<li>使用ScalerHandler接收，最终会传出一个数字，代表该ID在record表有几行数据</li>
</ul>
</li>
</ul>
</li>
<li><p>将MemberBiz结合于用户管理Biz中</p>
<ul>
<li>关于将信息存至req临时转发到相关页面的方法，可以参考userList的servlet</li>
<li>存在req，cession，application里面的都可以用<code>jspl:forEach</code>遍历</li>
<li><span class="red">前端注意：用户列表的href应该设定为<code>UserServlet?type=getAllUser</code></span></li>
</ul>
</li>
</ul>
<h2 id="22-03-08"><a href="#22-03-08" class="headerlink" title="22/03/08"></a>22/03/08</h2><ul>
<li><p>已解决点击修改个人资料、修改书籍类型资料时 预备悬浮窗应该提前显示当前修改对象的值的问题</p>
</li>
<li><p>关于点击修改xx资料时，修改表单自动填入当前数据的实现方法：</p>
<blockquote>
<p>由于不采取转发数据并跳转到其他页面的操作，我们需要在前端取现有的数据并且填入表单<br>并且由于表格中使用了for循环生成行，每一行的元素属性都一样，因此不能通过直接筛选class和id的方法<br>思路是给每一个修改按钮绑定事件，并且由该修改按钮出发，相对于该按钮定位该行需要提取的内容</p>
  <pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; 定位每个class&#x3D;mr-2的元素，为每个元素执行方法
$(&quot;.mr-2&quot;).each(function (index, element) &#123;
    &#x2F;&#x2F; 为定位到的元素设置点击事件
    $(this).click(function () &#123;
        &#x2F;* 相对于该按钮
        挑选其含有class&#x3D;text-right的父标签
        然后挑选该标签含有class&#x3D;userId&#x2F;userName&#x2F;userTel的同级标签
        分别赋给变量
        *&#x2F;
        let changeUserId &#x3D; $(this).parents(&quot;.text-right&quot;).prevAll(&quot;.userId&quot;).text();
        let changeUserName &#x3D; $(this).parents(&quot;.text-right&quot;).prevAll(&quot;.userName&quot;).text();
        let changeUserTel &#x3D; $(this).parents(&quot;.text-right&quot;).prevAll(&quot;.userTel&quot;).text();

        &#x2F;&#x2F; 定位到表单元素，分别将变量设定为表单各项的值
        $(&quot;#changeUserIdDis&quot;).attr(&quot;value&quot;, changeUserId);
        $(&quot;#changeUserIdHid&quot;).attr(&quot;value&quot;, changeUserId);
        $(&quot;#changeUserName&quot;).attr(&quot;value&quot;, changeUserName);
        $(&quot;#changeUserTel&quot;).attr(&quot;value&quot;, changeUserTel);
    &#125;)
&#125;)</code></pre>
<p>停止你的.parent().parent().prev().prev().prev()行为</p>
</blockquote>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jquery/traversing_parents.asp"><code>parents()</code></a>可以选择该标签的所有父标签，括号内可以使用<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jquery/jquery_ref_selectors.asp">选择器</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jquery/traversing_prevall.asp"><code>prevAll()</code></a>可以选择该标签的所有同级标签，括号内可以使用<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jquery/jquery_ref_selectors.asp">选择器</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/487885946509382292.html">jquery获取td标签内容</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40646143/article/details/79974025">jquery向input赋值</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hailexuexi/p/6708110.html">关于jquery控制select当前选项</a></p>
</li>
</ul>
  <pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; 根据获取到的当前书籍类型Id，对比option中的value值，在表单中默认选出
$(&quot;#changeParentType&quot;).val(changeParentId);</code></pre>

<ul>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/q/1010000005183377">向选择器传入变量</a>，当方法和选择器镶嵌并且需要传入变量时，需要将变量名从引号中拿出来，让其识别为一个变量名</li>
</ul>
  <pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; 根据获取到的当前书籍类型名，对比option中的选项名，在表单中默认选出
$(&quot;#changeBookType&quot;).children(&quot;:contains(&#39;&quot; + changeBookType + &quot;&#39;)&quot;).attr(&quot;selected&quot;,true);</code></pre></li>
</ul>
<h2 id="22-03-09"><a href="#22-03-09" class="headerlink" title="22/03/09"></a>22/03/09</h2><ul>
<li><p>用户注册，新增管理员功能已完成</p>
</li>
<li><p>删除用户功能：前端会分为管理员删除与用户注销</p>
</li>
<li><p>删除账户两个功能已完成</p>
</li>
<li><p>更改个人信息： 前端分为管理员更改用户个人信息与用户自行更改个人信息</p>
</li>
<li><p>管理员修改用户个人信息已完成</p>
</li>
<li><p><span class="red">后端注意:用户自行更改个人信息未完成</span></p>
</li>
</ul>
<h2 id="22-03-10"><a href="#22-03-10" class="headerlink" title="22/03/10"></a>22/03/10</h2><ul>
<li><p>把悬浮窗都实现一下，需要实现悬浮窗的页面有</p>
<ol>
<li>login：用户注册</li>
<li>bookList：新增书籍信息 修改书籍信息（已完成）</li>
<li>profileAdmin：修改个人信息<span class="red">前端注意:用户自行更改个人信息未完成</span></li>
<li>profileUser：修改个人信息<span class="red">前端注意:用户自行更改个人信息未完成</span></li>
<li>typeList：新增书籍类型信息 修改书籍类型信息</li>
<li>userList：新增管理员 修改用户信息</li>
</ol>
</li>
<li><p>前端debug</p>
<ul>
<li>书籍列表页面增删改已全部测试无异常</li>
<li>书籍类型列表增删改已全部测试无异常</li>
<li>用户信息列表增删改已全部测试无异常</li>
</ul>
</li>
<li><p>dataTables样式文件&amp;js文件已全部替换</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xuerong/p/8710124.html">dataTables第二页事件失效问题</a></p>
</li>
</ul>
<h2 id="22-03-11"><a href="#22-03-11" class="headerlink" title="22/03/11"></a>22/03/11</h2><ul>
<li>重磅：图书借阅功能今天开始</li>
</ul>
<br />

<ul>
<li><p>借书功能（ajax异步刷新）</p>
<ul>
<li><p>根据手机号获取用户信息</p>
<ul>
<li><p>注意事项</p>
<ul>
<li>使用ajax异步获取数据，则不能将信息存储在req、session、application中，需要将数据转换成json字符串，将该字符串传回页面</li>
<li><span class="red">注意：传输json使用out.print，不可以换行，换行会导致多出一行空行导致json不识别</span></li>
</ul>
</li>
<li><p>前端</p>
<ol>
<li>新建图书借阅功能界面</li>
<li>前端导入jquary</li>
<li>新建获取当前用户信息<ul>
<li>从session中取得当前登录用户电话号码</li>
<li>给按钮绑定事件，点击按钮时，将当前用户电话号码通过jquary的get方法发送到指定url处</li>
<li>该方法会返回一个请求状态status和服务端返回来的数据data</li>
<li>data为json字符串，使用parse方法将其转换为对象，即可提取对象属性内容，将需要的内容打印在表格上</li>
<li>禁用获取按钮<pre class="line-numbers language-js" data-language="js"><code class="language-js">$(function () &#123;
        &#x2F;&#x2F; 先禁用书籍查询按钮&amp;借阅按钮（未定义）
        $(&quot;#unnamed&quot;).prop(&quot;disabled&quot;, &quot;disabled&quot;);
        $(&quot;#unnamed&quot;).prop(&quot;disabled&quot;, &quot;disabled&quot;);

        $(&quot;#getCurrentUser&quot;).click(function () &#123;
            &#x2F;&#x2F; 获取当前用户手机号
            let content &#x3D; $(&quot;#tel&quot;).val();

            &#x2F;&#x2F; 调用ajax方法
            let url &#x3D; &quot;UserServlet?type&#x3D;ajaxReq&amp;tel&#x3D;&quot; + content;
            $.get(url, function (data, status) &#123;
                &#x2F;&#x2F; 将json字符串转换成json对象
                let currentuser &#x3D; JSON.parse(data);
                &#x2F;&#x2F; 给下面的表格赋值
                $(&quot;#currentUserId&quot;).html(currentuser.id);
                $(&quot;#currentUserName&quot;).html(currentuser.name);
                $(&quot;#currentUserType&quot;).html(currentuser.userType.typeName);
                $(&quot;#currentUserTel&quot;).html(currentuser.tel);
                $(&quot;#currentUserRecord&quot;).html(currentuser.recordLength);
            &#125;);
            &#x2F;&#x2F; 关闭获取当前用户按钮
            $(this).prop(&quot;disabled&quot;, &quot;disabled&quot;);

            &#x2F;&#x2F; 启用书籍查询按钮&amp;借阅按钮（未定义）
            $(&quot;#unnamed&quot;).removeAttr(&quot;disabled&quot;);
            $(&quot;#unnamed&quot;).removeAttr(&quot;disabled&quot;);
        &#125;);
    &#125;);</code></pre></li>
</ul>
</li>
<li>关于修改td（表格）里面的值<ul>
<li>使用html()修改</li>
</ul>
</li>
</ol>
<ul>
<li><span class="red">前端注意：探索一个根据当前用户类型隐藏标签 或 根据当前用户类型跳转的方法</span></li>
</ul>
</li>
<li><p>后端</p>
<ol>
<li>Userservlet新增方法，通过手机号获取用户信息</li>
</ol>
<ul>
<li>引入新包fastjson，用于将数据转换为json字符串发送（注意：虽然同样用print方法，但是不能换行）</li>
</ul>
<ol start="2">
<li>关于通过用户手机号获取用户借阅书籍信息：<ul>
<li>明确：需要通过user表的tel字段，查询record表中该用户的数据行数</li>
<li>子查询<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">-- SELECT * FROM record WHERE userid &#x3D; ?
-- 合在一起（子查询）
-- SELECT id FROM &#96;user&#96; WHERE tel &#x3D; &#39;56123456568&#39;;

SELECT * FROM record WHERE userid &#x3D; (SELECT id FROM &#96;user&#96; WHERE tel &#x3D; &#39;56123456568&#39;);</code></pre></li>
</ul>
</li>
<li>在User类新增recordLength属性，该属性不存于数据库中，仅用于需要使用时即查询</li>
<li>在将对象打包为json字符串之前，为对象补充recordLength属性的值</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="22-03-12"><a href="#22-03-12" class="headerlink" title="22/03/12"></a>22/03/12</h2><ul>
<li><p>完成书籍搜索功能</p>
</li>
<li><p>书籍搜索功能已实现</p>
  <pre class="line-numbers language-js" data-language="js"><code class="language-js">&#x2F;&#x2F; 搜索书籍
$(&quot;#searchByBookName&quot;).click(function () &#123;
    let bookName &#x3D; $(&quot;#bookName&quot;).val();
    let url &#x3D; &quot;BookServlet?type&#x3D;ajaxReq&amp;name&#x3D;&quot; + bookName;
    $.get(url, function (data, status) &#123;
        if (data &#x3D;&#x3D; &quot;&#123;&#125;&quot;) &#123;
            alert(&quot;书籍不存在&quot;);
            $(&quot;#bookName&quot;).attr(&quot;value&quot;, &quot;&quot;);
            return;
        &#125; else &#123;
            let book &#x3D; JSON.parse(data);
            console.log(book);
            &#x2F;&#x2F; 创建行
            let tr &#x3D; $(&quot;&lt;tr&gt;&quot;);
            &#x2F;&#x2F; 创建列
            let tdCheck &#x3D; $(&quot;&lt;td&gt;&lt;input type&#x3D;\&quot;checkbox\&quot; value&#x3D;\&quot;&quot; + book.id + &quot;\&quot; class&#x3D;\&quot;check\&quot; checked&gt;&lt;&#x2F;td&gt;&quot;);
            let tdBookName &#x3D; $(&quot;&lt;td&gt;&quot; + book.name + &quot;&lt;&#x2F;td&gt;&quot;);
            let tdBookType &#x3D; $(&quot;&lt;td&gt;&quot; + book.type.name +&quot;&lt;&#x2F;td&gt;&quot;);
            let tdDesc &#x3D; $(&quot;&lt;td&gt;&quot; + book.desc + &quot;&lt;&#x2F;td&gt;&quot;);
            let tdAuthor &#x3D; $(&quot;&lt;td&gt;&quot; + book.author + &quot;&lt;&#x2F;td&gt;&quot;);
            let tdPublish &#x3D; $(&quot;&lt;td&gt;&quot; + book.publish + &quot;&lt;&#x2F;td&gt;&quot;);
            let tdStock &#x3D; $(&quot;&lt;td&gt;&quot; + book.stock + &quot;&lt;&#x2F;td&gt;&quot;);
            let tdBorrowDate &#x3D; $(&quot;&lt;td&gt;&quot; + &quot;now&quot; + &quot;&lt;&#x2F;td&gt;&quot;);
            let tdReturnDate &#x3D; $(&quot;&lt;td&gt;&quot; + &quot;+30days&quot; + &quot;&lt;&#x2F;td&gt;&quot;);
            &#x2F;&#x2F; 行附加列
            tr.append(tdCheck);
            tr.append(tdBookName);
            tr.append(tdBookType);
            tr.append(tdDesc);
            tr.append(tdAuthor);
            tr.append(tdPublish);
            tr.append(tdStock);
            tr.append(tdBorrowDate);
            tr.append(tdReturnDate);
            &#x2F;&#x2F; 表附加行
            $(&quot;#bookSearch&quot;).append(tr);
        &#125;
    &#125;);
&#125;);</code></pre>
<ol>
<li>当按下查询按钮时，将输入框的值（书名）通过jquary的get方法传入服务端</li>
<li>服务端接收到书名调用方法查询书籍信息：<ul>
<li>结果为空，返回空json字符串</li>
<li>查询到书籍，返回书籍信息json字符串</li>
</ul>
</li>
<li>前端接收字符串并转换为对象，在表格中新建行和列<ul>
<li>使用<code>$(&quot;&quot;)</code>即可创建标签</li>
<li>使用<code>append()</code>将括号内标签附加在调用append方法的标签中<br /></li>
</ul>
</li>
</ol>
<ul>
<li><p>借阅时间/归还时间方法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">&lt;%-- 获取当前时间  --%&gt;
function getBorrowDate() &#123;
    let date &#x3D; new Date();
    let year &#x3D; date.getFullYear();
    &#x2F;&#x2F; 0~11
    let month &#x3D; date.getMonth() + 1;
    let day &#x3D; date.getDate();

    let currentDate &#x3D; year + &quot;&#x2F;&quot; + month + &quot;&#x2F;&quot; + day;
    return currentDate;
&#125;

&lt;%-- 计算归还时间  --%&gt;
function getReturnDate() &#123;
    &#x2F;&#x2F; 获取当前时间
    let date &#x3D; new Date();
    &#x2F;&#x2F; 转换为毫秒数
    let milliseconds &#x3D; date.getMilliseconds();
    &#x2F;&#x2F; 计算归还毫秒数(30天)
    let returnMills &#x3D; milliseconds +&#x3D; 30 * 24 * 60 * 60 * 1000;
    &#x2F;&#x2F; 转换为日期
    date.setMilliseconds(returnMills);
    &#x2F;&#x2F; 转换为字符串
    let year &#x3D; date.getFullYear();
    &#x2F;&#x2F; 0~11
    let month &#x3D; date.getMonth() + 1;
    let day &#x3D; date.getDate();

    let returnDate &#x3D; year + &quot;&#x2F;&quot; + month + &quot;&#x2F;&quot; + day;
    return returnDate;
&#125;</code></pre></li>
<li><p>解决多次搜索同一本书方法</p>
<ul>
<li>新建一个数组，使用<code>push()</code>将成功查询到的书籍名存在数组里</li>
<li>并且每次查询之前使用<code>indexof()</code>查询当前查询书籍在数组中的位置，没有查到会返回-1，查询到会返回下标</li>
</ul>
</li>
<li><p>确认借阅方法</p>
<ul>
<li>新建一个数组</li>
<li>当点击确认借阅按钮时，遍历表格中每一行，查找带有checked属性的标签，找到一个就将其value属性（之前已经设定好了搜出来的书籍第一行的value是书籍ID）push进数组</li>
</ul>
</li>
<li><p>解决用户不选择任何书籍的方法</p>
<ul>
<li>新建一个计数变量，每次遍历到checked就+1，最后判断计数变量是否为0</li>
</ul>
</li>
<li><p>关于如何提交一个数组变量</p>
<ul>
<li><p>前端</p>
<ul>
<li>数组调用<code>join()</code>方法将数组里面的元素以特定的分隔符（分隔符作为join的参数传入）将数组里面的元素转换为字符串</li>
<li>将该字符串以同步请求的方式（因为要跳转页面所以没必要异步）提交给服务端</li>
</ul>
</li>
<li><p>后端</p>
<ul>
<li>调用<code>split()</code>方法根据特定的正则表达式拆分字符串，返回一个字符串数组</li>
<li>将字符串数组中的每个元素转换为long类型（数组中是书籍id）存到一个新的list中</li>
</ul>
</li>
</ul>
</li>
<li><p>新错误（WDNMD睡一觉就报错？？？）</p>
<ul>
<li><span class="red">不要动jsp头里面的language=”java”！！！！</span><br><img src="https://s1.ax1x.com/2022/03/14/bL5Fw8.png" alt="bL5Fw8.png"></li>
</ul>
</li>
</ul>
</li>
<li><p>乱抄写了一个DBHelper，原Helper作废</p>
</li>
<li><p>图书借阅功能已完成</p>
</li>
</ul>
<h2 id="22-03-13"><a href="#22-03-13" class="headerlink" title="22/03/13"></a>22/03/13</h2><ul>
<li><p>时间对比实现</p>
</li>
<li><p>书籍归还实现了一半</p>
</li>
<li><p>获取当前时间和比较借阅时间的方法：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"></code></pre></li>
</ul>
<h2 id="22-03-14"><a href="#22-03-14" class="headerlink" title="22/03/14"></a>22/03/14</h2>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Java/" rel="tag"># Java</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/02/22/Java%E6%B3%A8%E8%A7%A3%E4%B8%8E%E5%8F%8D%E5%B0%84/" rel="prev" title="Java注解与反射">
                  <i class="fa fa-chevron-left"></i> Java注解与反射
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/03/24/Idea%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" rel="next" title="Idea常用快捷键">
                  Idea常用快捷键 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Loliconkelvin</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.24.1/components/prism-core.min.js" integrity="sha256-dz05jjFU9qYuMvQQlE6iWDtNAnEsmu6uMb1vWhKdkEM=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.24.1/plugins/autoloader/prism-autoloader.min.js" integrity="sha256-sttoa+EIAvFFfeeIkmPn8ypyOOb6no2sZ2NbxtBXgqU=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.24.1/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha256-K837BwIyiXo5k/9fCYgqUyA14bN4/Ve9P2SIT0KmZD0=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
